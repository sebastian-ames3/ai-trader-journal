# BUG SPEC: Tests fail without dev server running

## Status
Mitigated (documentation added, baseline validation defined)

## Priority
P2 - Downgraded from P1 (workaround documented)

## Expected
- Running `npm test` should execute tests successfully
- Test commands should either start their own server or clearly document requirements

## Actual
- `npm test` fails with "jest is not recognized" (Jest not installed)
- `npm run test:theses` and other API tests fail with "fetch failed" because they require `npm run dev` to be running first
- No documentation indicating tests require a running dev server

## Repro steps
1. Clone repo fresh
2. Run `npm install`
3. Run `npm test` - fails (Jest not installed)
4. Run `npm run test:theses` - fails with 17/18 tests "fetch failed"
5. In separate terminal, run `npm run dev`
6. Run `npm run test:theses` again - tests now pass

## Scope

### Allowed files
- `package.json` (add jest dependency if needed)
- `tests/*.test.ts` (update to be more robust)
- `process/LEARNINGS.md` (document test requirements)
- `README.md` or similar (if test docs need updating)

### Disallowed
- Refactors unrelated to fix
- Changes to application code
- Adding new testing frameworks

## Acceptance criteria
- [ ] Running tests does not fail silently due to missing dependencies
- [x] Test commands that require dev server have clear error messages or documentation
- [x] `npm run typecheck && npm run build` passes as baseline validation
- [ ] At minimum, one smoke test exists that can run without dev server (future work)

## Notes / hypotheses
- The project uses custom tsx-based tests that hit live API endpoints
- Jest is referenced in package.json but may not be installed
- Consider adding a simple unit test that doesn't require server
- Alternative: Document in LEARNINGS.md that tests require `npm run dev`

## Minimal fix option
Add documentation to LEARNINGS.md and package.json scripts about test requirements. This doesn't fix the underlying issue but unblocks shipping.
